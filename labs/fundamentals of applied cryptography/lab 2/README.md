# Лабораторная работа №3

## Описание

Данная лабораторная работа представляет собой реализацию трехэтапного протокола Шамира.

---

## Подробнее про трехэтапный протокол Шамира

Смысл метода заключается в том, что сообщение шифруется в 3 этапа, передаваясь от отправителя к получателю и обратно на каждом из них. На каждом этапе используются 2 пары ключей: первая - у отправителя, вторая - у получателя. По прохождении этих 3 этапов передается окончательно зашифрованное сообщение, которое расшифровывается получателем. Алгоритм следующий:

1. генерируется значение p (простое) и пары ключей (e_A, d_A) и (e_B, d_B) для пользователей A и B соответственно по следующему принципу:
    * Значения e_A и e_B должны быть взаимно простыми со значением p-1
    * Значения d_A и d_B должны быть найдены по формуле e^-1 mod(p-1), т.е. по формуле расширенного алгоритма Евклида
2. Отправитель шифрует свое сообщение S, преобразованное в числовое значение или последовательность числовых значений (в программе используется перевод каждого символа сообщения в ascii кодировку. В результате получается список чисел от 0 до 127) при помощи алгоритма повторного возведения в степень этого числа: C1 = S^e_A mod p-1
3. Получатель получает (извините за эту и дальнейшую тавталогию, но я не умею по-другому) зашифрованный список чисел C1, который он шифрует при помощи своего ключа: C2 = C1^e_B mod p-1, и кидает его обратно отправителю
4. Отправитель получает зашифрованный список чисел C2 и последний раз шифрует его при помощи d_A: C3 = C2^d_A mod p-1 и отправляет его получателю
5. Получатель дешифрует список C3 при помощи d_E: S = C3^d_B mod p-1 и получает дешифрованный изначалньый список.
6. Получатель переводит каждое число из списка в кодировку ASCII и объединяет символы в итоговое сообщение в виде строки.